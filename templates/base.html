{% load static widget_tweaks user_extras %}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>{% block title %}VV-Kaffee{% endblock %}</title>
  <meta name="description" content="{% block meta_description %}Rwandan specialty coffee roasted for Germany. Shop VV-Kaffee online.{% endblock %}">
  <link rel="canonical" href="{{ canonical_url }}">
  {% block robots %}<meta name="robots" content="index,follow">{% endblock %}

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600&family=Nunito+Sans:wght@300;400;600&display=swap" rel="stylesheet">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

  <!-- Mailchimp CSS first -->
  <link href="//cdn-images.mailchimp.com/embedcode/classic-061523.css" rel="stylesheet" type="text/css">

  <!-- Your CSS last so it wins -->
  <link rel="stylesheet" href="{% static 'css/vv-kaffee.css' %}">
</head>

  <body class="bg-light">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="{% url 'home' %}">
          <img src="{% static 'branding/logo.png' %}" alt="VV Kaffee" width="28" height="28" class="rounded">
          <span class="fw-semibold">Home</span>
        </a>
        <!-- Navbar toggler for mobile -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar" aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="mainNavbar">
          {% with current=request.resolver_match.url_name %}
          <ul class="navbar-nav me-auto">
            <li class="nav-item"><a class="nav-link {% if current == 'product_list' %}active-nav{% endif %}" href="{% url 'products:product_list' %}">Shop</a></li>
            {% if worker_user and staff_mode_active %}
              <li class="nav-item"><a class="nav-link {% if current == 'staff_admin_hub' %}active-nav{% endif %}" href="{% url 'staff_admin_hub' %}">Admin Hub</a></li>
              {% if perms.products.add_product or perms.products.change_product or perms.products.delete_product or perms.products.view_product %}
                <li class="nav-item"><a class="nav-link {% if current == 'staff_product_list' %}active-nav{% endif %}" href="{% url 'products:staff_product_list' %}">Products Management</a></li>
              {% endif %}
              {% if perms.orders.view_order or perms.orders.change_order or perms.orders.delete_order %}
                <li class="nav-item"><a class="nav-link {% if current == 'staff_order_list' %}active-nav{% endif %}" href="{% url 'orders:staff_order_list' %}">Orders Management</a></li>
              {% endif %}
              {% if perms.orders.view_fulfillment or user|has_group:"Fulfillment Department" %}
                <li class="nav-item"><a class="nav-link {% if current == 'fulfillment_paid_orders' or current == 'fulfillment_recent' %}active-nav{% endif %}" href="{% url 'orders:fulfillment_paid_orders' %}">Fulfillment</a></li>
              {% endif %}
            {% endif %}
            {% if user.is_authenticated and not worker_user or user.is_authenticated and not staff_mode_active %}
              <li class="nav-item"><a class="nav-link {% if current == 'my_orders' %}active-nav{% endif %}" href="{% url 'orders:my_orders' %}">My Orders</a></li>
              <li class="nav-item"><a class="nav-link {% if current == 'account_dashboard' %}active-nav{% endif %}" href="{% url 'profiles:account_dashboard' %}">My Account</a></li>
            {% endif %}
          </ul>
          {% endwith %}

          <ul class="navbar-nav align-items-lg-center gap-lg-2 ms-auto">
            {% if user.is_authenticated %}
              <li class="nav-item dropdown d-flex align-items-center gap-2">
                <span class="text-light small d-none d-md-inline">Welcome,</span>
                <a class="nav-link dropdown-toggle" href="#" id="accountMenu" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  {{ user.username|default:user.email }}
                </a>
                {% if worker_user %}
                  <span class="badge {% if staff_mode_active %}bg-warning text-dark{% else %}bg-secondary{% endif %}">
                    {% if staff_mode_active %}Work mode{% else %}Customer mode{% endif %}
                  </span>
                {% endif %}
                {% if user.profile and user.profile.image %}
                  <img src="{{ user.profile.image.url }}" alt="Profile image" class="rounded-circle border" style="width:32px;height:32px;object-fit:cover;">
                {% else %}
                  <div class="rounded-circle bg-secondary text-white d-flex align-items-center justify-content-center" style="width:32px;height:32px;font-size:0.85rem;">
                    {{ user.username|slice:":1"|default:user.email|slice:":1"|upper }}
                  </div>
                {% endif %}
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="accountMenu">
                  <li><a class="dropdown-item" href="{% url 'profiles:profile_edit' %}">Profile</a></li>
                  {% if worker_user %}
                    <li><hr class="dropdown-divider"></li>
                    <li class="dropdown-item-text">
                      {% if staff_mode_active %}
                        <span class="badge bg-warning text-dark">Work mode</span>
                        {% if staff_role_labels %}
                          <div class="small text-muted">Roles: {{ staff_role_labels|join:", " }}</div>
                        {% endif %}
                        <div class="small text-muted">Customer links hidden.</div>
                      {% else %}
                        <span class="badge bg-secondary">Customer mode</span>
                        <div class="small text-muted">Work links hidden so you can shop.</div>
                      {% endif %}
                    </li>
                    <li>
                      <form method="post" action="{% url 'profiles:toggle_staff_mode' %}" class="px-3 py-2">
                        {% csrf_token %}
                        <input type="hidden" name="next" value="{{ request.get_full_path }}">
                        <input type="hidden" name="mode" value="{% if staff_mode_active %}customer{% else %}staff{% endif %}">
                        <button class="btn btn-outline-primary w-100" type="submit">
                          {% if staff_mode_active %}Switch to customer mode{% else %}Switch to work mode{% endif %}
                        </button>
                      </form>
                    </li>
                  {% endif %}
                  <li><hr class="dropdown-divider"></li>
                  <li>
                    <form method="post" action="{% url 'account_logout' %}" class="px-3 py-1">
                      {% csrf_token %}
                      <button class="btn btn-link p-0 text-danger" type="submit">Logout</button>
                    </form>
                  </li>
                </ul>
              </li>
            {% else %}
              <li class="nav-item"><a class="nav-link" href="{% url 'account_login' %}">Login</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'account_signup' %}">Register</a></li>
            {% endif %}
            {% if not worker_user or not staff_mode_active %}
              <li class="nav-item">
                <a class="btn btn-dark position-relative" href="{% url 'cart:detail' %}">
                  Cart
                  {% if cart_item_count %}
                    <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                      {{ cart_item_count }}
                    </span>
                  {% endif %}
                </a>
              </li>
            {% endif %}
          </ul>
        </div>
      </div>
    </nav>

    <!-- Page Content -->
    <main class="container py-5">
      {% if messages %}
        <div class="mb-3">
          {% for message in messages %}
            {% with tag=message.tags|default:"info" %}
              <div class="alert alert-{% if tag == 'error' %}danger{% else %}{{ tag }}{% endif %} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
              </div>
            {% endwith %}
          {% endfor %}
        </div>
      {% endif %}
      {% block content %}{% endblock %}
    </main>

   <!-- Professional Footer -->
    <footer class="vv-footer mt-auto">
        <div class="footer-pattern"></div>
        
        <div class="footer-main">
            <div class="container">
                <!-- Brand Section -->
                <div class="footer-brand">
                    <img src="{% static 'branding/logo.png' %}" alt="VV Kaffee" class="footer-logo">
                    <h3 class="footer-title">Versöhnung und Vergebung</h3>
                    <p class="footer-tagline">Kaffee mit Herz</p>
                </div>

                <!-- Footer Grid -->
                <div class="footer-grid">
                    <!-- Location -->
                    <div class="footer-section footer-visit">
                        <h4>Besuchen Sie uns</h4>
                        <address class="footer-address">
                            <span class="street">Hopfauerstraße 33</span>
                            <span class="city">70563 Stuttgart, Germany</span>
                        </address>
                        <p style="margin-top: 1rem;">
                            <a href="tel:+49711XXXXXXX">
                                <i class="fas fa-phone-alt" style="margin-right: 0.5rem; font-size: 0.8rem;"></i>
                                +49 15228980488
                            </a>
                        </p>
                    </div>

                    <!-- Hours -->
                    <div class="footer-section footer-hours-col">
                        <h4>Öffnungszeiten</h4>
                        <div class="footer-hours">
                            <div class="hours-row">
                                <span class="hours-day">Mo – Fr</span>
                                <span>8:00 – 18:00</span>
                            </div>
                            <div class="hours-row">
                                <span class="hours-day">Samstag</span>
                                <span>9:00 – 17:00</span>
                            </div>
                            <div class="hours-row">
                                <span class="hours-day">Sonntag</span>
                                <span>Geschlossen</span>
                            </div>
                        </div>
                    </div>

                    <!-- Social -->
                    <div class="footer-section footer-social">
                        <h4>Folgen Sie uns</h4>
                        <p>Bleiben Sie auf dem Laufenden mit unseren neuesten Angeboten</p>
                        <div class="social-links">
                            <a href="https://www.facebook.com/profile.php?id=61588056042160" class="social-link" target="_blank" rel="noopener noreferrer nofollow" aria-label="Facebook">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                            <a href="https://wa.me/4915228980488" class="social-link" target="_blank" rel="noopener noreferrer nofollow" aria-label="WhatsApp">
                               <i class="fab fa-whatsapp"></i>
                            </a>
                            <a href="mailto:nvip2020@gmail.com" class="social-link" rel="nofollow" aria-label="Email">
                                <i class="fas fa-envelope"></i>
                            </a>
                        </div>
                    </div>
                        
                    <!--Mailchimp Subscription Integration-->
                    <div class="footer-section footer-subscribe" id="mc_embed_shell">
                        <div id="mc_embed_signup">
                            <form action="https://herokuapp.us15.list-manage.com/subscribe/post?u=2c802c8d4e56ddf8cd1a89938&amp;id=cdd8616230&amp;f_id=00479fe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank">
                                <div id="mc_embed_signup_scroll"><h2>Subscribe</h2>
                                    <div class="indicates-required"><span class="asterisk">*</span> indicates required</div>
                                    <div class="mc-field-group"><label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label><input type="email" name="EMAIL" class="required email" id="mce-EMAIL" required="" value=""></div>
                                    <div class="mc-field-group"><label for="mce-FNAME">First Name </label><input type="text" name="FNAME" class=" text" id="mce-FNAME" value=""></div>
                                <div id="mce-responses" class="clear foot">
                                    <div class="response" id="mce-error-response" style="display: none;"></div>
                                    <div class="response" id="mce-success-response" style="display: none;"></div>
                                </div>
                            <div aria-hidden="true" style="position: absolute; left: -5000px;">
                                /* real people should not fill this in and expect good things - do not remove this or risk form bot signups */
                                <input type="text" name="b_2c802c8d4e56ddf8cd1a89938_cdd8616230" tabindex="-1" value="">
                            </div>
                            <div class="optionalParent">
            <div class="clear foot">
                <input type="submit" name="subscribe" id="mc-embedded-subscribe" class="button" value="Subscribe">
                <p style="margin: 0px auto;"><a href="http://eepurl.com/jzKRvc" title="Mailchimp - email marketing made easy and fun"><span style="display: inline-block; background-color: transparent; border-radius: 4px;"><img class="refferal_badge" src="https://digitalasset.intuit.com/render/content/dam/intuit/mc-fe/en_us/images/intuit-mc-rewards-text-dark.svg" alt="Intuit Mailchimp" style="width: 220px; height: 40px; display: flex; padding: 2px 0px; justify-content: center; align-items: center;"></span></a></p>
            </div>
        </div>

                            </div>
                        </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer Bottom -->
        <div class="footer-bottom">
            <div class="container">
                <p class="footer-copyright">
                  © {% now 'Y' %} Versöhnung und Vergebung Kaffee. Alle Rechte vorbehalten.
                </p>
                <div class="footer-links">
                    <a href="#">Impressum</a>
                    <a href="https://www.termsfeed.com/live/e3a4a1d5-8579-48aa-8505-e50d9931910b">Datenschutz</a>
                    <a href="#">AGB</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Mailchimp script-->
    <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';fnames[3]='ADDRESS';ftypes[3]='address';fnames[4]='PHONE';ftypes[4]='phone';fnames[5]='BIRTHDAY';ftypes[5]='birthday';fnames[6]='COMPANY';ftypes[6]='text';}(jQuery));var $mcj = jQuery.noConflict(true);
                    // SMS Phone Multi-Country Functionality
                    if(!window.MC) {
                      window.MC = {};
                    }
                    window.MC.smsPhoneData = {
                      defaultCountryCode: 'DE',
                      programs: [],
                      smsProgramDataCountryNames: []
                    };

                    function getCountryUnicodeFlag(countryCode) {
                      return countryCode.toUpperCase().replace(/./g, (char) => String.fromCodePoint(char.charCodeAt(0) + 127397))
                    };

                    // HTML sanitization function to prevent XSS
                    function sanitizeHtml(str) {
                      if (typeof str !== 'string') return '';
                      return str
                        .replace(/&/g, '&amp;')
                        .replace(/</g, '&lt;')
                        .replace(/>/g, '&gt;')
                        .replace(/"/g, '&quot;')
                        .replace(/'/g, '&#x27;')
                        .replace(/\//g, '&#x2F;');
                    }

                    // URL sanitization function to prevent javascript: and data: URLs
                    function sanitizeUrl(url) {
                      if (typeof url !== 'string') return '';
                      const trimmedUrl = url.trim().toLowerCase();
                      if (trimmedUrl.startsWith('javascript:') || trimmedUrl.startsWith('data:') || trimmedUrl.startsWith('vbscript:')) {
                        return '#';
                      }
                      return url;
                    }

                    const getBrowserLanguage = () => {
                      if (!window?.navigator?.language?.split('-')[1]) {
                        return window?.navigator?.language?.toUpperCase();
                      }
                      return window?.navigator?.language?.split('-')[1];
                    };

                    function getDefaultCountryProgram(defaultCountryCode, smsProgramData) {
                      if (!smsProgramData || smsProgramData.length === 0) {
                        return null;
                      }

                      const browserLanguage = getBrowserLanguage();

                      if (browserLanguage) {
                        const foundProgram = smsProgramData.find(
                          (program) => program?.countryCode === browserLanguage,
                        );
                        if (foundProgram) {
                          return foundProgram;
                        }
                      }

                      if (defaultCountryCode) {
                        const foundProgram = smsProgramData.find(
                          (program) => program?.countryCode === defaultCountryCode,
                        );
                        if (foundProgram) {
                          return foundProgram;
                        }
                      }

                      return smsProgramData[0];
                    }

                    function updateSmsLegalText(countryCode, fieldName) {
                      if (!countryCode || !fieldName) {
                        return;
                      }
                      
                      const programs = window?.MC?.smsPhoneData?.programs;
                      if (!programs || !Array.isArray(programs)) {
                        return;
                      }
                      
                      const program = programs.find(program => program?.countryCode === countryCode);
                      if (!program || !program.requiredTemplate) {
                        return;
                      }
                      
                      const legalTextElement = document.querySelector('#legal-text-' + fieldName);
                      if (!legalTextElement) {
                        return;
                      }
                      
                      // Remove HTML tags and clean up the text
                      const divRegex = new RegExp('</?[div][^>]*>', 'gi');
                      const fullAnchorRegex = new RegExp('<a.*?</a>', 'g');
                      const anchorRegex = new RegExp('<a href="(.*?)" target="(.*?)">(.*?)</a>');
                      
                      const template = program.requiredTemplate.replace(divRegex, '');
                      
                      

                      legalTextElement.textContent = '';
                      const parts = template.split(/(<a href=".*?" target=".*?">.*?<\/a>)/g);
                      parts.forEach(function(part) {
                        if (!part) {
                          return;
                        }
                        const anchorMatch = part.match(/<a href="(.*?)" target="(.*?)">(.*?)<\/a>/);
                        if (anchorMatch) {
                          const linkElement = document.createElement('a');
                          linkElement.href = sanitizeUrl(anchorMatch[1]);
                          linkElement.target = sanitizeHtml(anchorMatch[2]);
                          linkElement.textContent = sanitizeHtml(anchorMatch[3]);
                          legalTextElement.appendChild(linkElement);
                        } else {
                          legalTextElement.appendChild(document.createTextNode(part));
                        }
                      });
                          
                    }

                    function generateDropdownOptions(smsProgramData) {
                      if (!smsProgramData || smsProgramData.length === 0) {
                        return '';
                      }
                      
                      return smsProgramData.map(program => {
                        const flag = getCountryUnicodeFlag(program.countryCode);
                        const countryName = getCountryName(program.countryCode);
                        const callingCode = program.countryCallingCode || '';
                        // Sanitize all values to prevent XSS
                        const sanitizedCountryCode = sanitizeHtml(program.countryCode || '');
                        const sanitizedCountryName = sanitizeHtml(countryName || '');
                        const sanitizedCallingCode = sanitizeHtml(callingCode || '');
                        return '<option value="' + sanitizedCountryCode + '">' + sanitizedCountryName + ' ' + sanitizedCallingCode + '</option>';
                      }).join('');
                    }

                    function getCountryName(countryCode) {
                      if (window.MC?.smsPhoneData?.smsProgramDataCountryNames && Array.isArray(window.MC.smsPhoneData.smsProgramDataCountryNames)) {
                        for (let i = 0; i < window.MC.smsPhoneData.smsProgramDataCountryNames.length; i++) {
                          if (window.MC.smsPhoneData.smsProgramDataCountryNames[i].code === countryCode) {
                            return window.MC.smsPhoneData.smsProgramDataCountryNames[i].name;
                          }
                        }
                      }
                      return countryCode;
                    }

                    function getDefaultPlaceholder(countryCode) {
                      if (!countryCode || typeof countryCode !== 'string') {
                        return '+1 000 000 0000'; // Default US placeholder
                      }
                      
                            var mockPlaceholders = [
                        {
                          countryCode: 'US',
                          placeholder: '+1 000 000 0000',
                          helpText: 'Include the US country code +1 before the phone number',
                        },
                        {
                          countryCode: 'GB',
                          placeholder: '+44 0000 000000',
                          helpText: 'Include the GB country code +44 before the phone number',
                        },
                        {
                          countryCode: 'CA',
                          placeholder: '+1 000 000 0000',
                          helpText: 'Include the CA country code +1 before the phone number',
                        },
                        {
                          countryCode: 'AU',
                          placeholder: '+61 000 000 000',
                          helpText: 'Include the AU country code +61 before the phone number',
                        },
                        {
                          countryCode: 'DE',
                          placeholder: '+49 000 0000000',
                          helpText: 'Fügen Sie vor der Telefonnummer die DE-Ländervorwahl +49 ein',
                        },
                        {
                          countryCode: 'FR',
                          placeholder: '+33 0 00 00 00 00',
                          helpText: 'Incluez le code pays FR +33 avant le numéro de téléphone',
                        },
                        {
                          countryCode: 'ES',
                          placeholder: '+34 000 000 000',
                          helpText: 'Incluya el código de país ES +34 antes del número de teléfono',
                        },
                        {
                          countryCode: 'NL',
                          placeholder: '+31 0 00000000',
                          helpText: 'Voeg de NL-landcode +31 toe vóór het telefoonnummer',
                        },
                        {
                          countryCode: 'BE',
                          placeholder: '+32 000 00 00 00',
                          helpText: 'Incluez le code pays BE +32 avant le numéro de téléphone',
                        },
                        {
                          countryCode: 'CH',
                          placeholder: '+41 00 000 00 00',
                          helpText: 'Fügen Sie vor der Telefonnummer die CH-Ländervorwahl +41 ein',
                        },
                        {
                          countryCode: 'AT',
                          placeholder: '+43 000 000 0000',
                          helpText: 'Fügen Sie vor der Telefonnummer die AT-Ländervorwahl +43 ein',
                        },
                        {
                          countryCode: 'IE',
                          placeholder: '+353 00 000 0000',
                          helpText: 'Include the IE country code +353 before the phone number',
                        },
                        {
                          countryCode: 'IT',
                          placeholder: '+39 000 000 0000',
                          helpText: 'Includere il prefisso internazionale IT +39 prima del numero di telefono',
                        },
                        {
                          countryCode: 'NO',
                          placeholder: '+47 000 00 000',
                          helpText: 'Inkluder NO landskode +47 før telefonnummeret',
                        },
                        {
                          countryCode: 'SE',
                          placeholder: '+46 00 000 00 00',
                          helpText: 'Inkludera SE landskod +46 före telefonnumret',
                        },
                        {
                          countryCode: 'DK',
                          placeholder: '+45 00 00 00 00',
                          helpText: 'Inkluder DK landekode +45 før telefonnummeret',
                        },
                        {
                          countryCode: 'FI',
                          placeholder: '+358 00 000 0000',
                          helpText: 'Sisällytä FI-maakoodi +358 ennen puhelinnumeroa',
                        },
                        {
                          countryCode: 'EE',
                          placeholder: '+372 0000 0000',
                          helpText: 'Lisage EE riigikood +372 telefoninumbri ette',
                        },
                        {
                          countryCode: 'PL',
                          placeholder: '+48 000 000 000',
                          helpText: 'Podaj numer kierunkowy PL +48 przed numerem telefonu',
                        },
                        {
                          countryCode: 'SK',
                          placeholder: '+421 000 000 000',
                          helpText: 'Pred telefónne číslo uveďte kód krajiny SK +421',
                        },
                        {
                          countryCode: 'LV',
                          placeholder: '+371 0000 0000',
                          helpText: 'Iekļaujiet LV valsts kodu +371 pirms tālruņa numura',
                        },
                        {
                          countryCode: 'LT',
                          placeholder: '+370 0000 0000',
                          helpText: 'Įtraukite LT šalies kodą +370 prieš telefono numerį',
                        },
                        {
                          countryCode: 'GR',
                          placeholder: '+30 000 000 0000',
                          helpText: 'Συμπεριλάβετε τον κωδικό χώρας GR +30 πριν από τον αριθμό τηλεφώνου',
                        },
                        {
                          countryCode: 'PT',
                          placeholder: '+351 000 000 000',
                          helpText: 'Inclua o código de país PT +351 antes do número de telefone',
                        },
                        {
                          countryCode: 'HR',
                          placeholder: '+385 00 000 0000',
                          helpText: 'Uključite HR pozivni broj države +385 prije telefonskog broja',
                        },
                        {
                          countryCode: 'SI',
                          placeholder: '+386 00 000 000',
                          helpText: 'Vključite SI kodo države +386 pred telefonsko številko',
                        },
                        {
                          countryCode: 'IS',
                          placeholder: '+354 000 0000',
                          helpText: 'Láttu IS landsnúmer +354 fylgja á undan símanúmerinu',
                        },
                        {
                          countryCode: 'LU',
                          placeholder: '+352 000 000 000',
                          helpText: 'Incluez le code pays LU +352 avant le numéro de téléphone',
                        },
                        {
                          countryCode: 'MC',
                          placeholder: '+377 00 00 00 00',
                          helpText: 'Incluez le code pays MC +377 avant le numéro de téléphone',
                        },
                        {
                          countryCode: 'AD',
                          placeholder: '+376 000 000',
                          helpText: 'Incloeu el codi de país AD +376 abans del número de telèfon',
                        },
                        {
                          countryCode: 'JE',
                          placeholder: '+44 0000 000000',
                          helpText: 'Include the JE country code +44 before the phone number',
                        },
                        {
                          countryCode: 'IM',
                          placeholder: '+44 0000 000000',
                          helpText: 'Include the IM country code +44 before the phone number',
                        },
                        {
                          countryCode: 'GG',
                          placeholder: '+44 0000 000000',
                          helpText: 'Include the GG country code +44 before the phone number',
                        },
                        {
                          countryCode: 'AL',
                          placeholder: '+355 00 000 0000',
                          helpText: 'Përfshini kodin e vendit AL +355 para numrit të telefonit',
                        },
                        {
                          countryCode: 'SM',
                          placeholder: '+378 0000 000000',
                          helpText: 'Includere il prefisso internazionale SM +378 prima del numero di telefono',
                        },
                        {
                          countryCode: 'FO',
                          placeholder: '+298 000000',
                          helpText: 'Inkluder FO landekode +298 før telefonnummeret',
                        },
                        {
                          countryCode: 'MT',
                          placeholder: '+356 0000 0000',
                          helpText: 'Include the MT country code +356 before the phone number',
                        },
                        {
                          countryCode: 'LI',
                          placeholder: '+423 000 0000',
                          helpText: 'Fügen Sie vor der Telefonnummer die LI-Ländervorwahl +423 ein',
                        },
                        {
                          countryCode: 'GI',
                          placeholder: '+350 000 00000',
                          helpText: 'Include the GI country code +350 before the phone number',
                        },
                        {
                          countryCode: 'MD',
                          placeholder: '+373 00 000 000',
                          helpText: 'Includeți codul de țară MD +373 înaintea numărului de telefon',
                        },
                        {
                          countryCode: 'HU',
                          placeholder: '+36 00 000 0000',
                          helpText: 'A telefonszám előtt adja meg a HU országkódot +36',
                        },
                        {
                          countryCode: 'NZ',
                          placeholder: '+64 00 000 0000',
                          helpText: 'Include the NZ country code +64 before the phone number',
                        },
                        {
                          countryCode: 'ME',
                          placeholder: '+382 00 000 000',
                          helpText: 'Uključite ME pozivni broj države +382 prije telefonskog broja',
                        },
                      ];

                      const selectedPlaceholder = mockPlaceholders.find(function(item) {
                        return item && item.countryCode === countryCode;
                      });
                      
                      return selectedPlaceholder ? selectedPlaceholder.placeholder : mockPlaceholders[0].placeholder;
                    }

                    function updatePlaceholder(countryCode, fieldName) {
                      if (!countryCode || !fieldName) {
                        return;
                      }
                      
                      const phoneInput = document.querySelector('#mce-' + fieldName);
                      if (!phoneInput) {
                        return;
                      }
                      
                      const placeholder = getDefaultPlaceholder(countryCode);
                      if (placeholder) {
                        phoneInput.placeholder = placeholder;
                      }
                    }

                    function updateCountryCodeInstruction(countryCode, fieldName) {
                      updatePlaceholder(countryCode, fieldName);
                      
                    }

                    function getDefaultHelpText(countryCode) {
                      var mockPlaceholders = [
                        {
                          countryCode: 'US',
                          placeholder: '+1 000 000 0000',
                          helpText: 'Include the US country code +1 before the phone number',
                        },
                        {
                          countryCode: 'GB',
                          placeholder: '+44 0000 000000',
                          helpText: 'Include the GB country code +44 before the phone number',
                        },
                        {
                          countryCode: 'CA',
                          placeholder: '+1 000 000 0000',
                          helpText: 'Include the CA country code +1 before the phone number',
                        },
                        {
                          countryCode: 'AU',
                          placeholder: '+61 000 000 000',
                          helpText: 'Include the AU country code +61 before the phone number',
                        },
                        {
                          countryCode: 'DE',
                          placeholder: '+49 000 0000000',
                          helpText: 'Fügen Sie vor der Telefonnummer die DE-Ländervorwahl +49 ein',
                        },
                        {
                          countryCode: 'FR',
                          placeholder: '+33 0 00 00 00 00',
                          helpText: 'Incluez le code pays FR +33 avant le numéro de téléphone',
                        },
                        {
                          countryCode: 'ES',
                          placeholder: '+34 000 000 000',
                          helpText: 'Incluya el código de país ES +34 antes del número de teléfono',
                        },
                        {
                          countryCode: 'NL',
                          placeholder: '+31 0 00000000',
                          helpText: 'Voeg de NL-landcode +31 toe vóór het telefoonnummer',
                        },
                        {
                          countryCode: 'BE',
                          placeholder: '+32 000 00 00 00',
                          helpText: 'Incluez le code pays BE +32 avant le numéro de téléphone',
                        },
                        {
                          countryCode: 'CH',
                          placeholder: '+41 00 000 00 00',
                          helpText: 'Fügen Sie vor der Telefonnummer die CH-Ländervorwahl +41 ein',
                        },
                        {
                          countryCode: 'AT',
                          placeholder: '+43 000 000 0000',
                          helpText: 'Fügen Sie vor der Telefonnummer die AT-Ländervorwahl +43 ein',
                        },
                        {
                          countryCode: 'IE',
                          placeholder: '+353 00 000 0000',
                          helpText: 'Include the IE country code +353 before the phone number',
                        },
                        {
                          countryCode: 'IT',
                          placeholder: '+39 000 000 0000',
                          helpText: 'Includere il prefisso internazionale IT +39 prima del numero di telefono',
                        },
                        {
                          countryCode: 'NO',
                          placeholder: '+47 000 00 000',
                          helpText: 'Inkluder NO landskode +47 før telefonnummeret',
                        },
                        {
                          countryCode: 'SE',
                          placeholder: '+46 00 000 00 00',
                          helpText: 'Inkludera SE landskod +46 före telefonnumret',
                        },
                        {
                          countryCode: 'DK',
                          placeholder: '+45 00 00 00 00',
                          helpText: 'Inkluder DK landekode +45 før telefonnummeret',
                        },
                        {
                          countryCode: 'FI',
                          placeholder: '+358 00 000 0000',
                          helpText: 'Sisällytä FI-maakoodi +358 ennen puhelinnumeroa',
                        },
                        {
                          countryCode: 'EE',
                          placeholder: '+372 0000 0000',
                          helpText: 'Lisage EE riigikood +372 telefoninumbri ette',
                        },
                        {
                          countryCode: 'PL',
                          placeholder: '+48 000 000 000',
                          helpText: 'Podaj numer kierunkowy PL +48 przed numerem telefonu',
                        },
                        {
                          countryCode: 'SK',
                          placeholder: '+421 000 000 000',
                          helpText: 'Pred telefónne číslo uveďte kód krajiny SK +421',
                        },
                        {
                          countryCode: 'LV',
                          placeholder: '+371 0000 0000',
                          helpText: 'Iekļaujiet LV valsts kodu +371 pirms tālruņa numura',
                        },
                        {
                          countryCode: 'LT',
                          placeholder: '+370 0000 0000',
                          helpText: 'Įtraukite LT šalies kodą +370 prieš telefono numerį',
                        },
                        {
                          countryCode: 'GR',
                          placeholder: '+30 000 000 0000',
                          helpText: 'Συμπεριλάβετε τον κωδικό χώρας GR +30 πριν από τον αριθμό τηλεφώνου',
                        },
                        {
                          countryCode: 'PT',
                          placeholder: '+351 000 000 000',
                          helpText: 'Inclua o código de país PT +351 antes do número de telefone',
                        },
                        {
                          countryCode: 'HR',
                          placeholder: '+385 00 000 0000',
                          helpText: 'Uključite HR pozivni broj države +385 prije telefonskog broja',
                        },
                        {
                          countryCode: 'SI',
                          placeholder: '+386 00 000 000',
                          helpText: 'Vključite SI kodo države +386 pred telefonsko številko',
                        },
                        {
                          countryCode: 'IS',
                          placeholder: '+354 000 0000',
                          helpText: 'Láttu IS landsnúmer +354 fylgja á undan símanúmerinu',
                        },
                        {
                          countryCode: 'LU',
                          placeholder: '+352 000 000 000',
                          helpText: 'Incluez le code pays LU +352 avant le numéro de téléphone',
                        },
                        {
                          countryCode: 'MC',
                          placeholder: '+377 00 00 00 00',
                          helpText: 'Incluez le code pays MC +377 avant le numéro de téléphone',
                        },
                        {
                          countryCode: 'AD',
                          placeholder: '+376 000 000',
                          helpText: 'Incloeu el codi de país AD +376 abans del número de telèfon',
                        },
                        {
                          countryCode: 'JE',
                          placeholder: '+44 0000 000000',
                          helpText: 'Include the JE country code +44 before the phone number',
                        },
                        {
                          countryCode: 'IM',
                          placeholder: '+44 0000 000000',
                          helpText: 'Include the IM country code +44 before the phone number',
                        },
                        {
                          countryCode: 'GG',
                          placeholder: '+44 0000 000000',
                          helpText: 'Include the GG country code +44 before the phone number',
                        },
                        {
                          countryCode: 'AL',
                          placeholder: '+355 00 000 0000',
                          helpText: 'Përfshini kodin e vendit AL +355 para numrit të telefonit',
                        },
                        {
                          countryCode: 'SM',
                          placeholder: '+378 0000 000000',
                          helpText: 'Includere il prefisso internazionale SM +378 prima del numero di telefono',
                        },
                        {
                          countryCode: 'FO',
                          placeholder: '+298 000000',
                          helpText: 'Inkluder FO landekode +298 før telefonnummeret',
                        },
                        {
                          countryCode: 'MT',
                          placeholder: '+356 0000 0000',
                          helpText: 'Include the MT country code +356 before the phone number',
                        },
                        {
                          countryCode: 'LI',
                          placeholder: '+423 000 0000',
                          helpText: 'Fügen Sie vor der Telefonnummer die LI-Ländervorwahl +423 ein',
                        },
                        {
                          countryCode: 'GI',
                          placeholder: '+350 000 00000',
                          helpText: 'Include the GI country code +350 before the phone number',
                        },
                        {
                          countryCode: 'MD',
                          placeholder: '+373 00 000 000',
                          helpText: 'Includeți codul de țară MD +373 înaintea numărului de telefon',
                        },
                        {
                          countryCode: 'HU',
                          placeholder: '+36 00 000 0000',
                          helpText: 'A telefonszám előtt adja meg a HU országkódot +36',
                        },
                        {
                          countryCode: 'NZ',
                          placeholder: '+64 00 000 0000',
                          helpText: 'Include the NZ country code +64 before the phone number',
                        },
                        {
                          countryCode: 'ME',
                          placeholder: '+382 00 000 000',
                          helpText: 'Uključite ME pozivni broj države +382 prije telefonskog broja',
                        },
                      ];
                      
                      if (!countryCode || typeof countryCode !== 'string') {
                        return mockPlaceholders[0].helpText;
                      }
                      
                      const selectedHelpText = mockPlaceholders.find(function(item) {
                          return item && item.countryCode === countryCode;
                        });
                        
                        return selectedHelpText ? selectedHelpText.helpText : mockPlaceholders[0].helpText;
                    }

                    function setDefaultHelpText(countryCode) {
                      const helpTextSpan = document.querySelector('#help-text');
                      if (!helpTextSpan) {
                        return;
                      }

                        
                    }

                    function updateHelpTextCountryCode(countryCode, fieldName) {
                      if (!countryCode || !fieldName) {
                        return;
                      }
                      
                      setDefaultHelpText(countryCode);
                    }

                    function initializeSmsPhoneDropdown(fieldName) {
                      if (!fieldName || typeof fieldName !== 'string') {
                        return;
                      }
                      
                      const dropdown = document.querySelector('#country-select-' + fieldName);
                      const displayFlag = document.querySelector('#flag-display-' + fieldName);
                      
                      if (!dropdown || !displayFlag) {
                        return;
                      }

                      const smsPhoneData = window.MC?.smsPhoneData;
                      if (smsPhoneData && smsPhoneData.programs && Array.isArray(smsPhoneData.programs)) {
                        dropdown.innerHTML = generateDropdownOptions(smsPhoneData.programs);
                      }

                      const defaultProgram = getDefaultCountryProgram(smsPhoneData?.defaultCountryCode, smsPhoneData?.programs);
                      if (defaultProgram && defaultProgram.countryCode) {
                        dropdown.value = defaultProgram.countryCode;
                        
                        const flagSpan = displayFlag?.querySelector('#flag-emoji-' + fieldName);
                        if (flagSpan) {
                          flagSpan.textContent = getCountryUnicodeFlag(defaultProgram.countryCode);
                          flagSpan.setAttribute('aria-label', sanitizeHtml(defaultProgram.countryCode) + ' flag');
                        }
                        
                        updateSmsLegalText(defaultProgram.countryCode, fieldName);
                        updatePlaceholder(defaultProgram.countryCode, fieldName);
                        updateCountryCodeInstruction(defaultProgram.countryCode, fieldName);
                      }

                    
                      var smsNotRequiredRemoveCountryCodeEnabled = true;
                      var smsField = Object.values({"EMAIL":{"name":"EMAIL","label":"Email Address","helper_text":"","merge_id":0,"type":"email","required":true,"audience_field_name":"Email Address","field_type":"merge","enabled":true,"order":0},"FNAME":{"name":"FNAME","label":"First Name","helper_text":"","type":"text","required":false,"audience_field_name":"First Name","enabled":true,"order":1,"field_type":"merge","merge_id":1},"LNAME":{"name":"LNAME","label":"Last Name","helper_text":"","type":"text","required":false,"audience_field_name":"Last Name","enabled":false,"order":null,"field_type":"merge","merge_id":2},"ADDRESS":{"name":"ADDRESS","label":"Address","helper_text":"","type":"address","required":false,"audience_field_name":"Address","enabled":false,"order":null,"field_type":"merge","merge_id":3,"countries":{"2":"Albania","3":"Algeria","4":"Andorra","5":"Angola","6":"Argentina","7":"Armenia","8":"Australia","9":"Austria","10":"Azerbaijan","11":"Bahamas","12":"Bahrain","13":"Bangladesh","14":"Barbados","15":"Belarus","16":"Belgium","17":"Belize","18":"Benin","19":"Bermuda","20":"Bhutan","21":"Bolivia","22":"Bosnia and Herzegovina","23":"Botswana","24":"Brazil","25":"Bulgaria","26":"Burkina Faso","27":"Burundi","28":"Cambodia","29":"Cameroon","30":"Canada","31":"Cape Verde","32":"Cayman Islands","33":"Central African Republic","34":"Chad","35":"Chile","36":"China","37":"Colombia","38":"Congo","40":"Croatia","41":"Cyprus","42":"Czech Republic","43":"Denmark","44":"Djibouti","45":"Ecuador","46":"Egypt","47":"El Salvador","48":"Equatorial Guinea","49":"Eritrea","50":"Estonia","51":"Ethiopia","52":"Fiji","53":"Finland","54":"France","56":"Gabon","57":"Gambia","58":"Georgia","59":"Germany","60":"Ghana","61":"Greece","62":"Guam","63":"Guinea","64":"Guinea-Bissau","65":"Guyana","66":"Honduras","67":"Hong Kong","68":"Hungary","69":"Iceland","70":"India","71":"Indonesia","74":"Ireland","75":"Israel","76":"Italy","78":"Japan","79":"Jordan","80":"Kazakhstan","81":"Kenya","82":"Kuwait","83":"Kyrgyzstan","84":"Lao People's Democratic Republic","85":"Latvia","86":"Lebanon","87":"Lesotho","88":"Liberia","90":"Liechtenstein","91":"Lithuania","92":"Luxembourg","93":"Macedonia","94":"Madagascar","95":"Malawi","96":"Malaysia","97":"Maldives","98":"Mali","99":"Malta","100":"Mauritania","101":"Mexico","102":"Moldova","103":"Monaco","104":"Mongolia","105":"Morocco","106":"Mozambique","107":"Namibia","108":"Nepal","109":"Netherlands","110":"Netherlands Antilles","111":"New Zealand","112":"Nicaragua","113":"Niger","114":"Nigeria","116":"Norway","117":"Oman","118":"Pakistan","119":"Panama","120":"Paraguay","121":"Peru","122":"Philippines","123":"Poland","124":"Portugal","126":"Qatar","127":"Reunion","128":"Romania","129":"Russia","130":"Rwanda","132":"Samoa (Independent)","133":"Saudi Arabia","134":"Senegal","135":"Seychelles","136":"Sierra Leone","137":"Singapore","138":"Slovakia","139":"Slovenia","140":"Somalia","141":"South Africa","142":"South Korea","143":"Spain","144":"Sri Lanka","146":"Suriname","147":"Swaziland","148":"Sweden","149":"Switzerland","152":"Taiwan","153":"Tanzania","154":"Thailand","155":"Togo","156":"Tunisia","157":"Turkiye","158":"Turkmenistan","159":"Uganda","161":"Ukraine","162":"United Arab Emirates","163":"Uruguay","164":"USA","165":"Uzbekistan","166":"Vatican City State (Holy See)","167":"Venezuela","168":"Vietnam","169":"Virgin Islands (British)","170":"Yemen","173":"Zambia","174":"Zimbabwe","175":"Antigua And Barbuda","176":"Anguilla","178":"American Samoa","179":"Aruba","180":"Brunei Darussalam","181":"Bouvet Island","183":"Cook Islands","185":"Christmas Island","187":"Dominican Republic","188":"Western Sahara","189":"Falkland Islands","191":"Faroe Islands","192":"Grenada","193":"French Guiana","194":"Gibraltar","195":"Greenland","196":"Guadeloupe","198":"Guatemala","200":"Haiti","202":"Jamaica","203":"Kiribati","204":"Comoros","205":"Saint Kitts and Nevis","206":"Saint Lucia","207":"Marshall Islands","208":"Macau","210":"Martinique","212":"Mauritius","213":"New Caledonia","214":"Norfolk Island","215":"Nauru","217":"Niue","219":"Papua New Guinea","221":"Pitcairn","222":"Palau","223":"Solomon Islands","225":"Svalbard and Jan Mayen Islands","227":"San Marino","232":"Tonga","233":"Timor-Leste","234":"Trinidad and Tobago","235":"Tuvalu","237":"Saint Vincent and the Grenadines","238":"Virgin Islands (U.S.)","239":"Vanuatu","241":"Mayotte","242":"Myanmar","255":"Sao Tome and Principe","257":"South Georgia and the South Sandwich Islands","260":"Tajikistan","262":"United Kingdom","268":"Costa Rica","270":"Guernsey","272":"North Korea","274":"Afghanistan","275":"Cote D'Ivoire","276":"Cuba","277":"French Polynesia","278":"Iran","279":"Iraq","281":"Libya","282":"Palestine","285":"Syria","286":"Aaland Islands","287":"Turks & Caicos Islands","288":"Jersey  (Channel Islands)","289":"Dominica","290":"Montenegro","293":"Sudan","294":"Montserrat","298":"Curacao","302":"Sint Maarten","311":"South Sudan","315":"Republic of Kosovo","318":"Congo, Democratic Republic of the","323":"Isle of Man","324":"Saint Martin","325":"Bonaire, Saint Eustatius and Saba","326":"Serbia"},"defaultcountry":164},"PHONE":{"name":"PHONE","label":"Phone Number","helper_text":"","type":"phone","required":false,"audience_field_name":"Phone Number","phoneformat":"","enabled":false,"order":null,"field_type":"merge","merge_id":4},"BIRTHDAY":{"name":"BIRTHDAY","label":"Birthday","helper_text":"","type":"birthday","required":false,"audience_field_name":"Birthday","dateformat":"MM/DD","enabled":false,"order":null,"field_type":"merge","merge_id":5},"COMPANY":{"name":"COMPANY","label":"Company","helper_text":"","type":"text","required":false,"audience_field_name":"Company","enabled":false,"order":null,"field_type":"merge","merge_id":6}}).find(function(f) { return f.name === fieldName && f.type === 'smsphone'; });
                      var isRequired = smsField ? smsField.required : false;
                      var shouldAppendCountryCode = smsNotRequiredRemoveCountryCodeEnabled ? isRequired : true;
                      
                      var phoneInput = document.querySelector('#mce-' + fieldName);
                      if (phoneInput && defaultProgram.countryCallingCode && shouldAppendCountryCode) {
                        phoneInput.value = defaultProgram.countryCallingCode;
                      }
                      


                      displayFlag?.addEventListener('click', function(e) {
                        dropdown.focus();
                      });


                      dropdown?.addEventListener('change', function() {
                        const selectedCountry = this.value;
                        
                        if (!selectedCountry || typeof selectedCountry !== 'string') {
                          return;
                        }
                        
                        const flagSpan = displayFlag?.querySelector('#flag-emoji-' + fieldName);
                        if (flagSpan) {
                          flagSpan.textContent = getCountryUnicodeFlag(selectedCountry);
                          flagSpan.setAttribute('aria-label', sanitizeHtml(selectedCountry) + ' flag');
                        }

                        
                        const selectedProgram = window.MC?.smsPhoneData?.programs.find(function(program) {
                          return program && program.countryCode === selectedCountry;
                        });

                        var smsNotRequiredRemoveCountryCodeEnabled = true;
                        var smsField = Object.values({"EMAIL":{"name":"EMAIL","label":"Email Address","helper_text":"","merge_id":0,"type":"email","required":true,"audience_field_name":"Email Address","field_type":"merge","enabled":true,"order":0},"FNAME":{"name":"FNAME","label":"First Name","helper_text":"","type":"text","required":false,"audience_field_name":"First Name","enabled":true,"order":1,"field_type":"merge","merge_id":1},"LNAME":{"name":"LNAME","label":"Last Name","helper_text":"","type":"text","required":false,"audience_field_name":"Last Name","enabled":false,"order":null,"field_type":"merge","merge_id":2},"ADDRESS":{"name":"ADDRESS","label":"Address","helper_text":"","type":"address","required":false,"audience_field_name":"Address","enabled":false,"order":null,"field_type":"merge","merge_id":3,"countries":{"2":"Albania","3":"Algeria","4":"Andorra","5":"Angola","6":"Argentina","7":"Armenia","8":"Australia","9":"Austria","10":"Azerbaijan","11":"Bahamas","12":"Bahrain","13":"Bangladesh","14":"Barbados","15":"Belarus","16":"Belgium","17":"Belize","18":"Benin","19":"Bermuda","20":"Bhutan","21":"Bolivia","22":"Bosnia and Herzegovina","23":"Botswana","24":"Brazil","25":"Bulgaria","26":"Burkina Faso","27":"Burundi","28":"Cambodia","29":"Cameroon","30":"Canada","31":"Cape Verde","32":"Cayman Islands","33":"Central African Republic","34":"Chad","35":"Chile","36":"China","37":"Colombia","38":"Congo","40":"Croatia","41":"Cyprus","42":"Czech Republic","43":"Denmark","44":"Djibouti","45":"Ecuador","46":"Egypt","47":"El Salvador","48":"Equatorial Guinea","49":"Eritrea","50":"Estonia","51":"Ethiopia","52":"Fiji","53":"Finland","54":"France","56":"Gabon","57":"Gambia","58":"Georgia","59":"Germany","60":"Ghana","61":"Greece","62":"Guam","63":"Guinea","64":"Guinea-Bissau","65":"Guyana","66":"Honduras","67":"Hong Kong","68":"Hungary","69":"Iceland","70":"India","71":"Indonesia","74":"Ireland","75":"Israel","76":"Italy","78":"Japan","79":"Jordan","80":"Kazakhstan","81":"Kenya","82":"Kuwait","83":"Kyrgyzstan","84":"Lao People's Democratic Republic","85":"Latvia","86":"Lebanon","87":"Lesotho","88":"Liberia","90":"Liechtenstein","91":"Lithuania","92":"Luxembourg","93":"Macedonia","94":"Madagascar","95":"Malawi","96":"Malaysia","97":"Maldives","98":"Mali","99":"Malta","100":"Mauritania","101":"Mexico","102":"Moldova","103":"Monaco","104":"Mongolia","105":"Morocco","106":"Mozambique","107":"Namibia","108":"Nepal","109":"Netherlands","110":"Netherlands Antilles","111":"New Zealand","112":"Nicaragua","113":"Niger","114":"Nigeria","116":"Norway","117":"Oman","118":"Pakistan","119":"Panama","120":"Paraguay","121":"Peru","122":"Philippines","123":"Poland","124":"Portugal","126":"Qatar","127":"Reunion","128":"Romania","129":"Russia","130":"Rwanda","132":"Samoa (Independent)","133":"Saudi Arabia","134":"Senegal","135":"Seychelles","136":"Sierra Leone","137":"Singapore","138":"Slovakia","139":"Slovenia","140":"Somalia","141":"South Africa","142":"South Korea","143":"Spain","144":"Sri Lanka","146":"Suriname","147":"Swaziland","148":"Sweden","149":"Switzerland","152":"Taiwan","153":"Tanzania","154":"Thailand","155":"Togo","156":"Tunisia","157":"Turkiye","158":"Turkmenistan","159":"Uganda","161":"Ukraine","162":"United Arab Emirates","163":"Uruguay","164":"USA","165":"Uzbekistan","166":"Vatican City State (Holy See)","167":"Venezuela","168":"Vietnam","169":"Virgin Islands (British)","170":"Yemen","173":"Zambia","174":"Zimbabwe","175":"Antigua And Barbuda","176":"Anguilla","178":"American Samoa","179":"Aruba","180":"Brunei Darussalam","181":"Bouvet Island","183":"Cook Islands","185":"Christmas Island","187":"Dominican Republic","188":"Western Sahara","189":"Falkland Islands","191":"Faroe Islands","192":"Grenada","193":"French Guiana","194":"Gibraltar","195":"Greenland","196":"Guadeloupe","198":"Guatemala","200":"Haiti","202":"Jamaica","203":"Kiribati","204":"Comoros","205":"Saint Kitts and Nevis","206":"Saint Lucia","207":"Marshall Islands","208":"Macau","210":"Martinique","212":"Mauritius","213":"New Caledonia","214":"Norfolk Island","215":"Nauru","217":"Niue","219":"Papua New Guinea","221":"Pitcairn","222":"Palau","223":"Solomon Islands","225":"Svalbard and Jan Mayen Islands","227":"San Marino","232":"Tonga","233":"Timor-Leste","234":"Trinidad and Tobago","235":"Tuvalu","237":"Saint Vincent and the Grenadines","238":"Virgin Islands (U.S.)","239":"Vanuatu","241":"Mayotte","242":"Myanmar","255":"Sao Tome and Principe","257":"South Georgia and the South Sandwich Islands","260":"Tajikistan","262":"United Kingdom","268":"Costa Rica","270":"Guernsey","272":"North Korea","274":"Afghanistan","275":"Cote D'Ivoire","276":"Cuba","277":"French Polynesia","278":"Iran","279":"Iraq","281":"Libya","282":"Palestine","285":"Syria","286":"Aaland Islands","287":"Turks & Caicos Islands","288":"Jersey  (Channel Islands)","289":"Dominica","290":"Montenegro","293":"Sudan","294":"Montserrat","298":"Curacao","302":"Sint Maarten","311":"South Sudan","315":"Republic of Kosovo","318":"Congo, Democratic Republic of the","323":"Isle of Man","324":"Saint Martin","325":"Bonaire, Saint Eustatius and Saba","326":"Serbia"},"defaultcountry":164},"PHONE":{"name":"PHONE","label":"Phone Number","helper_text":"","type":"phone","required":false,"audience_field_name":"Phone Number","phoneformat":"","enabled":false,"order":null,"field_type":"merge","merge_id":4},"BIRTHDAY":{"name":"BIRTHDAY","label":"Birthday","helper_text":"","type":"birthday","required":false,"audience_field_name":"Birthday","dateformat":"MM/DD","enabled":false,"order":null,"field_type":"merge","merge_id":5},"COMPANY":{"name":"COMPANY","label":"Company","helper_text":"","type":"text","required":false,"audience_field_name":"Company","enabled":false,"order":null,"field_type":"merge","merge_id":6}}).find(function(f) { return f.name === fieldName && f.type === 'smsphone'; });
                        var isRequired = smsField ? smsField.required : false;
                        var shouldAppendCountryCode = smsNotRequiredRemoveCountryCodeEnabled ? isRequired : true;
                        
                        var phoneInput = document.querySelector('#mce-' + fieldName);
                        if (phoneInput && selectedProgram.countryCallingCode && shouldAppendCountryCode) {
                          phoneInput.value = selectedProgram.countryCallingCode;
                        }
                        
                        
                        updateSmsLegalText(selectedCountry, fieldName);
                        updatePlaceholder(selectedCountry, fieldName);
                        updateCountryCodeInstruction(selectedCountry, fieldName);
                      });
                    }

                    document.addEventListener('DOMContentLoaded', function() {
                      const smsPhoneFields = document.querySelectorAll('[id^="country-select-"]');
                      
                      smsPhoneFields.forEach(function(dropdown) {
                        const fieldName = dropdown?.id.replace('country-select-', '');
                        initializeSmsPhoneDropdown(fieldName);
                      });
                    });
                    </script>
    
  </body>
</html>
